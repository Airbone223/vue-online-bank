{"remainingRequest":"C:\\Local Disk\\projects\\vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Local Disk\\projects\\vue\\src\\use\\login-form.js","dependencies":[{"path":"C:\\Local Disk\\projects\\vue\\src\\use\\login-form.js","mtime":1619192710629},{"path":"C:\\Local Disk\\projects\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Local Disk\\projects\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudGltZXJzLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovTG9jYWwgRGlzay9wcm9qZWN0cy92dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgeyB1c2VGaWVsZCwgdXNlRm9ybSB9IGZyb20gJ3ZlZS12YWxpZGF0ZSc7CmltcG9ydCAqIGFzIHl1cCBmcm9tICd5dXAnOwppbXBvcnQgeyBjb21wdXRlZCwgd2F0Y2ggfSBmcm9tICd2dWUnOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOwpleHBvcnQgZnVuY3Rpb24gdXNlTG9naW5Gb3JtKCkgewogIHZhciBzdG9yZSA9IHVzZVN0b3JlKCk7CiAgdmFyIE1JTl9MRU5HVEggPSA2OwoKICB2YXIgX3VzZUZvcm0gPSB1c2VGb3JtKCksCiAgICAgIGhhbmRsZVN1Ym1pdCA9IF91c2VGb3JtLmhhbmRsZVN1Ym1pdCwKICAgICAgaXNTdWJtaXR0aW5nID0gX3VzZUZvcm0uaXNTdWJtaXR0aW5nLAogICAgICBzdWJtaXRDb3VudCA9IF91c2VGb3JtLnN1Ym1pdENvdW50OwoKICB2YXIgX3VzZUZpZWxkID0gdXNlRmllbGQoJ2VtYWlsJywgeXVwLnN0cmluZygpLnRyaW0oKS5yZXF1aXJlZCgn0JLQstC10LTQuNGC0LUgZW1haWwnKS5lbWFpbCgn0JLQstC10LTQuNGC0LUg0LrQvtGA0YDQtdC60YLQvdGL0LkgZW1haWwnKSksCiAgICAgIGVtYWlsID0gX3VzZUZpZWxkLnZhbHVlLAogICAgICBlRXJyb3IgPSBfdXNlRmllbGQuZXJyb3JNZXNzYWdlLAogICAgICBlQmx1ciA9IF91c2VGaWVsZC5oYW5kbGVCbHVyOwoKICB2YXIgX3VzZUZpZWxkMiA9IHVzZUZpZWxkKCdwYXNzd29yZCcsIHl1cC5zdHJpbmcoKS50cmltKCkucmVxdWlyZWQoJ9CS0LLQtdC00LjRgtC1INC/0LDRgNC+0LvRjCcpLm1pbihNSU5fTEVOR1RILCAiXHUwNDFDXHUwNDM4XHUwNDNEXHUwNDM4XHUwNDNDXHUwNDMwXHUwNDNCXHUwNDRDXHUwNDNEXHUwNDMwXHUwNDRGIFx1MDQzNFx1MDQzQlx1MDQzOFx1MDQzRFx1MDQzMCBcdTA0M0ZcdTA0MzBcdTA0NDBcdTA0M0VcdTA0M0JcdTA0NEYgIi5jb25jYXQoTUlOX0xFTkdUSCwgIiBcdTA0NDFcdTA0MzhcdTA0M0NcdTA0MzJcdTA0M0VcdTA0M0JcdTA0M0VcdTA0MzIiKSkpLAogICAgICBwYXNzd29yZCA9IF91c2VGaWVsZDIudmFsdWUsCiAgICAgIHBFcnJvciA9IF91c2VGaWVsZDIuZXJyb3JNZXNzYWdlLAogICAgICBwQmx1ciA9IF91c2VGaWVsZDIuaGFuZGxlQmx1cjsKCiAgdmFyIGlzVG9NYW55QXR0ZW1wdHMgPSBjb21wdXRlZChmdW5jdGlvbiAoKSB7CiAgICByZXR1cm4gc3VibWl0Q291bnQudmFsdWUgPj0gNTsKICB9KTsKICB3YXRjaChpc1RvTWFueUF0dGVtcHRzLCBmdW5jdGlvbiAodmFsKSB7CiAgICBpZiAodmFsKSB7CiAgICAgIHNldFRpbWVvdXQoZnVuY3Rpb24gKCkgewogICAgICAgIHJldHVybiBzdWJtaXRDb3VudC52YWx1ZSA9IDA7CiAgICAgIH0sIDMwMDAwKTsKICAgIH0KICB9KTsKICB2YXIgb25TdWJtaXQgPSBoYW5kbGVTdWJtaXQoIC8qI19fUFVSRV9fKi9mdW5jdGlvbiAoKSB7CiAgICB2YXIgX3JlZiA9IF9hc3luY1RvR2VuZXJhdG9yKCAvKiNfX1BVUkVfXyovcmVnZW5lcmF0b3JSdW50aW1lLm1hcmsoZnVuY3Rpb24gX2NhbGxlZSh2YWx1ZXMpIHsKICAgICAgcmV0dXJuIHJlZ2VuZXJhdG9yUnVudGltZS53cmFwKGZ1bmN0aW9uIF9jYWxsZWUkKF9jb250ZXh0KSB7CiAgICAgICAgd2hpbGUgKDEpIHsKICAgICAgICAgIHN3aXRjaCAoX2NvbnRleHQucHJldiA9IF9jb250ZXh0Lm5leHQpIHsKICAgICAgICAgICAgY2FzZSAwOgogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSAyOwogICAgICAgICAgICAgIHJldHVybiBzdG9yZS5kaXNwYXRjaCgnYXV0aC9sb2dpbicsIHZhbHVlcyk7CgogICAgICAgICAgICBjYXNlIDI6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUpOwogICAgfSkpOwoKICAgIHJldHVybiBmdW5jdGlvbiAoX3gpIHsKICAgICAgcmV0dXJuIF9yZWYuYXBwbHkodGhpcywgYXJndW1lbnRzKTsKICAgIH07CiAgfSgpKTsKICByZXR1cm4gewogICAgZW1haWw6IGVtYWlsLAogICAgcGFzc3dvcmQ6IHBhc3N3b3JkLAogICAgcEVycm9yOiBwRXJyb3IsCiAgICBlRXJyb3I6IGVFcnJvciwKICAgIHBCbHVyOiBwQmx1ciwKICAgIGVCbHVyOiBlQmx1ciwKICAgIG9uU3VibWl0OiBvblN1Ym1pdCwKICAgIGlzVG9NYW55QXR0ZW1wdHM6IGlzVG9NYW55QXR0ZW1wdHMsCiAgICBpc1N1Ym1pdHRpbmc6IGlzU3VibWl0dGluZwogIH07Cn0="},{"version":3,"sources":["C:/Local Disk/projects/vue/src/use/login-form.js"],"names":["useField","useForm","yup","computed","watch","useStore","useLoginForm","store","MIN_LENGTH","handleSubmit","isSubmitting","submitCount","string","trim","required","email","value","eError","errorMessage","eBlur","handleBlur","min","password","pError","pBlur","isToManyAttempts","val","setTimeout","onSubmit","values","dispatch"],"mappings":";;;;AAAA,SAAQA,QAAR,EAAkBC,OAAlB,QAAgC,cAAhC;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,SAAQC,QAAR,EAAkBC,KAAlB,QAA8B,KAA9B;AACA,SAASC,QAAT,QAAyB,MAAzB;AAGA,OAAO,SAASC,YAAT,GAAwB;AAC3B,MAAMC,KAAK,GAAGF,QAAQ,EAAtB;AACA,MAAMG,UAAU,GAAG,CAAnB;;AAF2B,iBAGuBP,OAAO,EAH9B;AAAA,MAGpBQ,YAHoB,YAGpBA,YAHoB;AAAA,MAGNC,YAHM,YAGNA,YAHM;AAAA,MAGQC,WAHR,YAGQA,WAHR;;AAAA,kBAKqCX,QAAQ,CACpE,OADoE,EAEpEE,GAAG,CAACU,MAAJ,GAAaC,IAAb,GAAoBC,QAApB,CAA6B,eAA7B,EAA8CC,KAA9C,CAAoD,0BAApD,CAFoE,CAL7C;AAAA,MAKbA,KALa,aAKpBC,KALoB;AAAA,MAKQC,MALR,aAKNC,YALM;AAAA,MAK4BC,KAL5B,aAKgBC,UALhB;;AAAA,mBASwCpB,QAAQ,CACvE,UADuE,EAEvEE,GAAG,CAACU,MAAJ,GAAaC,IAAb,GAAoBC,QAApB,CAA6B,gBAA7B,EAA+CO,GAA/C,CAAmDb,UAAnD,mJAA2FA,UAA3F,uDAFuE,CAThD;AAAA,MASbc,QATa,cASpBN,KAToB;AAAA,MASWO,MATX,cASHL,YATG;AAAA,MAS+BM,KAT/B,cASmBJ,UATnB;;AAc3B,MAAMK,gBAAgB,GAAGtB,QAAQ,CAAC;AAAA,WAAMQ,WAAW,CAACK,KAAZ,IAAqB,CAA3B;AAAA,GAAD,CAAjC;AAEAZ,EAAAA,KAAK,CAACqB,gBAAD,EAAmB,UAAAC,GAAG,EAAI;AAC3B,QAAIA,GAAJ,EAAS;AACLC,MAAAA,UAAU,CAAC;AAAA,eAAMhB,WAAW,CAACK,KAAZ,GAAoB,CAA1B;AAAA,OAAD,EAA8B,KAA9B,CAAV;AACH;AACJ,GAJI,CAAL;AAMA,MAAMY,QAAQ,GAAGnB,YAAY;AAAA,uEAAC,iBAAMoB,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBACpBtB,KAAK,CAACuB,QAAN,CAAe,YAAf,EAA6BD,MAA7B,CADoB;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;;AAAA;AAAA;AAAA;AAAA,MAA7B;AAIA,SAAO;AACHd,IAAAA,KAAK,EAALA,KADG;AAEHO,IAAAA,QAAQ,EAARA,QAFG;AAGHC,IAAAA,MAAM,EAANA,MAHG;AAIHN,IAAAA,MAAM,EAANA,MAJG;AAKHO,IAAAA,KAAK,EAALA,KALG;AAMHL,IAAAA,KAAK,EAALA,KANG;AAOHS,IAAAA,QAAQ,EAARA,QAPG;AAQHH,IAAAA,gBAAgB,EAAhBA,gBARG;AASHf,IAAAA,YAAY,EAAZA;AATG,GAAP;AAWH","sourcesContent":["import {useField, useForm} from 'vee-validate'\r\nimport * as yup from 'yup'\r\nimport {computed, watch} from 'vue'\r\nimport { useStore } from 'vuex'\r\n\r\n\r\nexport function useLoginForm() {\r\n    const store = useStore()\r\n    const MIN_LENGTH = 6\r\n    const {handleSubmit, isSubmitting, submitCount} = useForm()\r\n\r\n    const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\r\n        'email',\r\n        yup.string().trim().required('Введите email').email('Введите корректный email')\r\n    )\r\n    const {value: password, errorMessage: pError, handleBlur: pBlur} = useField(\r\n        'password',\r\n        yup.string().trim().required('Введите пароль').min(MIN_LENGTH, `Минимальная длина пароля ${MIN_LENGTH} символов`)\r\n    )\r\n\r\n    const isToManyAttempts = computed(() => submitCount.value >= 5)\r\n\r\n    watch(isToManyAttempts, val => {\r\n        if (val) {\r\n            setTimeout(() => submitCount.value = 0, 30000)\r\n        }\r\n    })\r\n\r\n    const onSubmit = handleSubmit(async values => {\r\n        await store.dispatch('auth/login', values)\r\n    })\r\n\r\n    return {\r\n        email,\r\n        password,\r\n        pError,\r\n        eError,\r\n        pBlur,\r\n        eBlur,\r\n        onSubmit,\r\n        isToManyAttempts,\r\n        isSubmitting\r\n    }\r\n}\r\n"]}]}