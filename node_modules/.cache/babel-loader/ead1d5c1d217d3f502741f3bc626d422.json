{"remainingRequest":"C:\\Local Disk\\projects\\vue\\node_modules\\babel-loader\\lib\\index.js!C:\\Local Disk\\projects\\vue\\src\\use\\login-form.js","dependencies":[{"path":"C:\\Local Disk\\projects\\vue\\src\\use\\login-form.js","mtime":1619255858157},{"path":"C:\\Local Disk\\projects\\vue\\node_modules\\cache-loader\\dist\\cjs.js","mtime":499162500000},{"path":"C:\\Local Disk\\projects\\vue\\node_modules\\babel-loader\\lib\\index.js","mtime":315532800000}],"contextDependencies":[],"result":[{"type":"Buffer","data":"base64:aW1wb3J0ICJjb3JlLWpzL21vZHVsZXMvZXMuc3RyaW5nLnRyaW0uanMiOwppbXBvcnQgImNvcmUtanMvbW9kdWxlcy93ZWIudGltZXJzLmpzIjsKaW1wb3J0ICJyZWdlbmVyYXRvci1ydW50aW1lL3J1bnRpbWUuanMiOwppbXBvcnQgX2FzeW5jVG9HZW5lcmF0b3IgZnJvbSAiQzovTG9jYWwgRGlzay9wcm9qZWN0cy92dWUvbm9kZV9tb2R1bGVzL0BiYWJlbC9ydW50aW1lL2hlbHBlcnMvZXNtL2FzeW5jVG9HZW5lcmF0b3IiOwppbXBvcnQgeyB1c2VGaWVsZCwgdXNlRm9ybSB9IGZyb20gJ3ZlZS12YWxpZGF0ZSc7CmltcG9ydCAqIGFzIHl1cCBmcm9tICd5dXAnOwppbXBvcnQgeyBjb21wdXRlZCwgd2F0Y2ggfSBmcm9tICd2dWUnOwppbXBvcnQgeyB1c2VTdG9yZSB9IGZyb20gJ3Z1ZXgnOwppbXBvcnQgeyB1c2VSb3V0ZXIgfSBmcm9tICd2dWUtcm91dGVyJzsKZXhwb3J0IGZ1bmN0aW9uIHVzZUxvZ2luRm9ybSgpIHsKICB2YXIgcm91dGVyID0gdXNlUm91dGVyKCk7CiAgdmFyIHN0b3JlID0gdXNlU3RvcmUoKTsKICB2YXIgTUlOX0xFTkdUSCA9IDY7CgogIHZhciBfdXNlRm9ybSA9IHVzZUZvcm0oKSwKICAgICAgaGFuZGxlU3VibWl0ID0gX3VzZUZvcm0uaGFuZGxlU3VibWl0LAogICAgICBpc1N1Ym1pdHRpbmcgPSBfdXNlRm9ybS5pc1N1Ym1pdHRpbmcsCiAgICAgIHN1Ym1pdENvdW50ID0gX3VzZUZvcm0uc3VibWl0Q291bnQ7CgogIHZhciBfdXNlRmllbGQgPSB1c2VGaWVsZCgnZW1haWwnLCB5dXAuc3RyaW5nKCkudHJpbSgpLnJlcXVpcmVkKCfQktCy0LXQtNC40YLQtSBlbWFpbCcpLmVtYWlsKCfQktCy0LXQtNC40YLQtSDQutC+0YDRgNC10LrRgtC90YvQuSBlbWFpbCcpKSwKICAgICAgZW1haWwgPSBfdXNlRmllbGQudmFsdWUsCiAgICAgIGVFcnJvciA9IF91c2VGaWVsZC5lcnJvck1lc3NhZ2UsCiAgICAgIGVCbHVyID0gX3VzZUZpZWxkLmhhbmRsZUJsdXI7CgogIHZhciBfdXNlRmllbGQyID0gdXNlRmllbGQoJ3Bhc3N3b3JkJywgeXVwLnN0cmluZygpLnRyaW0oKS5yZXF1aXJlZCgn0JLQstC10LTQuNGC0LUg0L/QsNGA0L7Qu9GMJykubWluKE1JTl9MRU5HVEgsICJcdTA0MUNcdTA0MzhcdTA0M0RcdTA0MzhcdTA0M0NcdTA0MzBcdTA0M0JcdTA0NENcdTA0M0RcdTA0MzBcdTA0NEYgXHUwNDM0XHUwNDNCXHUwNDM4XHUwNDNEXHUwNDMwIFx1MDQzRlx1MDQzMFx1MDQ0MFx1MDQzRVx1MDQzQlx1MDQ0RiAiLmNvbmNhdChNSU5fTEVOR1RILCAiIFx1MDQ0MVx1MDQzOFx1MDQzQ1x1MDQzMlx1MDQzRVx1MDQzQlx1MDQzRVx1MDQzMiIpKSksCiAgICAgIHBhc3N3b3JkID0gX3VzZUZpZWxkMi52YWx1ZSwKICAgICAgcEVycm9yID0gX3VzZUZpZWxkMi5lcnJvck1lc3NhZ2UsCiAgICAgIHBCbHVyID0gX3VzZUZpZWxkMi5oYW5kbGVCbHVyOwoKICB2YXIgaXNUb01hbnlBdHRlbXB0cyA9IGNvbXB1dGVkKGZ1bmN0aW9uICgpIHsKICAgIHJldHVybiBzdWJtaXRDb3VudC52YWx1ZSA+PSA1OwogIH0pOwogIHdhdGNoKGlzVG9NYW55QXR0ZW1wdHMsIGZ1bmN0aW9uICh2YWwpIHsKICAgIGlmICh2YWwpIHsKICAgICAgc2V0VGltZW91dChmdW5jdGlvbiAoKSB7CiAgICAgICAgcmV0dXJuIHN1Ym1pdENvdW50LnZhbHVlID0gMDsKICAgICAgfSwgMzAwMDApOwogICAgfQogIH0pOwogIHZhciBvblN1Ym1pdCA9IGhhbmRsZVN1Ym1pdCggLyojX19QVVJFX18qL2Z1bmN0aW9uICgpIHsKICAgIHZhciBfcmVmID0gX2FzeW5jVG9HZW5lcmF0b3IoIC8qI19fUFVSRV9fKi9yZWdlbmVyYXRvclJ1bnRpbWUubWFyayhmdW5jdGlvbiBfY2FsbGVlKHZhbHVlcykgewogICAgICByZXR1cm4gcmVnZW5lcmF0b3JSdW50aW1lLndyYXAoZnVuY3Rpb24gX2NhbGxlZSQoX2NvbnRleHQpIHsKICAgICAgICB3aGlsZSAoMSkgewogICAgICAgICAgc3dpdGNoIChfY29udGV4dC5wcmV2ID0gX2NvbnRleHQubmV4dCkgewogICAgICAgICAgICBjYXNlIDA6CiAgICAgICAgICAgICAgX2NvbnRleHQucHJldiA9IDA7CiAgICAgICAgICAgICAgX2NvbnRleHQubmV4dCA9IDM7CiAgICAgICAgICAgICAgcmV0dXJuIHN0b3JlLmRpc3BhdGNoKCdhdXRoL2xvZ2luJywgdmFsdWVzKTsKCiAgICAgICAgICAgIGNhc2UgMzoKICAgICAgICAgICAgICByb3V0ZXIucHVzaCgnLycpOwogICAgICAgICAgICAgIF9jb250ZXh0Lm5leHQgPSA4OwogICAgICAgICAgICAgIGJyZWFrOwoKICAgICAgICAgICAgY2FzZSA2OgogICAgICAgICAgICAgIF9jb250ZXh0LnByZXYgPSA2OwogICAgICAgICAgICAgIF9jb250ZXh0LnQwID0gX2NvbnRleHRbImNhdGNoIl0oMCk7CgogICAgICAgICAgICBjYXNlIDg6CiAgICAgICAgICAgIGNhc2UgImVuZCI6CiAgICAgICAgICAgICAgcmV0dXJuIF9jb250ZXh0LnN0b3AoKTsKICAgICAgICAgIH0KICAgICAgICB9CiAgICAgIH0sIF9jYWxsZWUsIG51bGwsIFtbMCwgNl1dKTsKICAgIH0pKTsKCiAgICByZXR1cm4gZnVuY3Rpb24gKF94KSB7CiAgICAgIHJldHVybiBfcmVmLmFwcGx5KHRoaXMsIGFyZ3VtZW50cyk7CiAgICB9OwogIH0oKSk7CiAgcmV0dXJuIHsKICAgIGVtYWlsOiBlbWFpbCwKICAgIHBhc3N3b3JkOiBwYXNzd29yZCwKICAgIHBFcnJvcjogcEVycm9yLAogICAgZUVycm9yOiBlRXJyb3IsCiAgICBwQmx1cjogcEJsdXIsCiAgICBlQmx1cjogZUJsdXIsCiAgICBvblN1Ym1pdDogb25TdWJtaXQsCiAgICBpc1RvTWFueUF0dGVtcHRzOiBpc1RvTWFueUF0dGVtcHRzLAogICAgaXNTdWJtaXR0aW5nOiBpc1N1Ym1pdHRpbmcKICB9Owp9"},{"version":3,"sources":["C:/Local Disk/projects/vue/src/use/login-form.js"],"names":["useField","useForm","yup","computed","watch","useStore","useRouter","useLoginForm","router","store","MIN_LENGTH","handleSubmit","isSubmitting","submitCount","string","trim","required","email","value","eError","errorMessage","eBlur","handleBlur","min","password","pError","pBlur","isToManyAttempts","val","setTimeout","onSubmit","values","dispatch","push"],"mappings":";;;;AAAA,SAAQA,QAAR,EAAkBC,OAAlB,QAAgC,cAAhC;AACA,OAAO,KAAKC,GAAZ,MAAqB,KAArB;AACA,SAAQC,QAAR,EAAkBC,KAAlB,QAA8B,KAA9B;AACA,SAASC,QAAT,QAAyB,MAAzB;AACA,SAASC,SAAT,QAA0B,YAA1B;AAGA,OAAO,SAASC,YAAT,GAAwB;AAC3B,MAAMC,MAAM,GAAGF,SAAS,EAAxB;AACA,MAAMG,KAAK,GAAGJ,QAAQ,EAAtB;AACA,MAAMK,UAAU,GAAG,CAAnB;;AAH2B,iBAIuBT,OAAO,EAJ9B;AAAA,MAIpBU,YAJoB,YAIpBA,YAJoB;AAAA,MAINC,YAJM,YAINA,YAJM;AAAA,MAIQC,WAJR,YAIQA,WAJR;;AAAA,kBAMqCb,QAAQ,CACpE,OADoE,EAEpEE,GAAG,CAACY,MAAJ,GAAaC,IAAb,GAAoBC,QAApB,CAA6B,eAA7B,EAA8CC,KAA9C,CAAoD,0BAApD,CAFoE,CAN7C;AAAA,MAMbA,KANa,aAMpBC,KANoB;AAAA,MAMQC,MANR,aAMNC,YANM;AAAA,MAM4BC,KAN5B,aAMgBC,UANhB;;AAAA,mBAUwCtB,QAAQ,CACvE,UADuE,EAEvEE,GAAG,CAACY,MAAJ,GAAaC,IAAb,GAAoBC,QAApB,CAA6B,gBAA7B,EAA+CO,GAA/C,CAAmDb,UAAnD,mJAA2FA,UAA3F,uDAFuE,CAVhD;AAAA,MAUbc,QAVa,cAUpBN,KAVoB;AAAA,MAUWO,MAVX,cAUHL,YAVG;AAAA,MAU+BM,KAV/B,cAUmBJ,UAVnB;;AAe3B,MAAMK,gBAAgB,GAAGxB,QAAQ,CAAC;AAAA,WAAMU,WAAW,CAACK,KAAZ,IAAqB,CAA3B;AAAA,GAAD,CAAjC;AAEAd,EAAAA,KAAK,CAACuB,gBAAD,EAAmB,UAAAC,GAAG,EAAI;AAC3B,QAAIA,GAAJ,EAAS;AACLC,MAAAA,UAAU,CAAC;AAAA,eAAMhB,WAAW,CAACK,KAAZ,GAAoB,CAA1B;AAAA,OAAD,EAA8B,KAA9B,CAAV;AACH;AACJ,GAJI,CAAL;AAMA,MAAMY,QAAQ,GAAGnB,YAAY;AAAA,uEAAC,iBAAMoB,MAAN;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,qBAElBtB,KAAK,CAACuB,QAAN,CAAe,YAAf,EAA6BD,MAA7B,CAFkB;;AAAA;AAGxBvB,cAAAA,MAAM,CAACyB,IAAP,CAAY,GAAZ;AAHwB;AAAA;;AAAA;AAAA;AAAA;;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA,KAAD;;AAAA;AAAA;AAAA;AAAA,MAA7B;AASA,SAAO;AACHhB,IAAAA,KAAK,EAALA,KADG;AAEHO,IAAAA,QAAQ,EAARA,QAFG;AAGHC,IAAAA,MAAM,EAANA,MAHG;AAIHN,IAAAA,MAAM,EAANA,MAJG;AAKHO,IAAAA,KAAK,EAALA,KALG;AAMHL,IAAAA,KAAK,EAALA,KANG;AAOHS,IAAAA,QAAQ,EAARA,QAPG;AAQHH,IAAAA,gBAAgB,EAAhBA,gBARG;AASHf,IAAAA,YAAY,EAAZA;AATG,GAAP;AAWH","sourcesContent":["import {useField, useForm} from 'vee-validate'\r\nimport * as yup from 'yup'\r\nimport {computed, watch} from 'vue'\r\nimport { useStore } from 'vuex'\r\nimport { useRouter } from 'vue-router'\r\n\r\n\r\nexport function useLoginForm() {\r\n    const router = useRouter()\r\n    const store = useStore()\r\n    const MIN_LENGTH = 6\r\n    const {handleSubmit, isSubmitting, submitCount} = useForm()\r\n\r\n    const {value: email, errorMessage: eError, handleBlur: eBlur} = useField(\r\n        'email',\r\n        yup.string().trim().required('Введите email').email('Введите корректный email')\r\n    )\r\n    const {value: password, errorMessage: pError, handleBlur: pBlur} = useField(\r\n        'password',\r\n        yup.string().trim().required('Введите пароль').min(MIN_LENGTH, `Минимальная длина пароля ${MIN_LENGTH} символов`)\r\n    )\r\n\r\n    const isToManyAttempts = computed(() => submitCount.value >= 5)\r\n\r\n    watch(isToManyAttempts, val => {\r\n        if (val) {\r\n            setTimeout(() => submitCount.value = 0, 30000)\r\n        }\r\n    })\r\n\r\n    const onSubmit = handleSubmit(async values => {\r\n      try {\r\n          await store.dispatch('auth/login', values)\r\n          router.push('/')\r\n      } catch (e) {\r\n\r\n      }\r\n    })\r\n\r\n    return {\r\n        email,\r\n        password,\r\n        pError,\r\n        eError,\r\n        pBlur,\r\n        eBlur,\r\n        onSubmit,\r\n        isToManyAttempts,\r\n        isSubmitting\r\n    }\r\n}\r\n"]}]}